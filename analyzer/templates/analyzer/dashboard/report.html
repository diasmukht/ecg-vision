<!DOCTYPE html>
{% load static %}
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <title>–û—Ç—á–µ—Ç #{{ exam.id }}</title>
    <style>
        body {
            background: #555; /* –¢–µ–º–Ω—ã–π —Ñ–æ–Ω –≤–æ–∫—Ä—É–≥ –ª–∏—Å—Ç–∞ */
            font-family: 'Times New Roman', serif;
            margin: 0;
            padding: 40px;
        }
        .a4-page {
            background: white;
            width: 210mm;
            min-height: 297mm;
            margin: 0 auto;
            padding: 20mm;
            box-shadow: 0 0 20px rgba(0,0,0,0.5);
            position: relative;
        }
        
        .header {
            border-bottom: 2px solid #000;
            padding-bottom: 20px;
            margin-bottom: 30px;
            display: flex;
            justify-content: space-between;
        }
        
        .logo-text {
            font-size: 24px;
            font-weight: bold;
            color: #0067FF;
        }
        
        .contact-info {
            font-size: 12px;
            color: #555;
            text-align: right;
        }

        .record-info {
            font-weight: bold;
            font-size: 14px;
            margin-bottom: 30px;
        }

        .section-title {
            font-size: 16px;
            font-weight: bold;
            text-transform: uppercase;
            border-bottom: 1px solid #ddd;
            padding-bottom: 5px;
            margin-top: 30px;
            margin-bottom: 15px;
        }

        .info-grid {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 10px;
            font-size: 14px;
        }
        
        .label { color: #666; width: 120px; display: inline-block; }

        .metrics-box {
            border: 1px solid #000;
            padding: 15px;
            margin-top: 10px;
            display: flex;
            justify-content: space-between;
            font-family: monospace;
            font-size: 16px;
        }

        .conclusion-box {
            background: #f9f9f9;
            padding: 15px;
            min-height: 100px;
            border: 1px solid #ddd;
            margin-top: 10px;
        }

        .footer {
            position: absolute;
            bottom: 20mm;
            left: 20mm;
            right: 20mm;
            text-align: center;
            font-size: 10px;
            color: #999;
            border-top: 1px solid #eee;
            padding-top: 10px;
        }

        @media print {
            body { background: white; padding: 0; }
            .a4-page { box-shadow: none; margin: 0; width: 100%; }
            .no-print { display: none; }
        }
        
        .btn-print {
            position: fixed;
            top: 20px; right: 20px;
            background: #0067FF;
            color: white;
            padding: 10px 20px;
            border: none;
            cursor: pointer;
            font-family: sans-serif;
            border-radius: 5px;
        }
    </style>
</head>
<body>

    <button class="btn-print no-print" onclick="window.print()">üñ® –ü–µ—á–∞—Ç—å / PDF</button>

    <div class="a4-page">
        <div class="header">
            <div>
                <div class="logo-text">ECG_Vision</div>
                <div style="font-size: 12px; margin-top: 5px;">–°–∏—Å—Ç–µ–º–∞ –ò–ò-–¥–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∏</div>
            </div>
            <div class="contact-info">
                ecg@mail.com<br>
                +7 705 436 6705<br>
                –ê–ª–º–∞—Ç—ã, –ö–∞–∑–∞—Ö—Å—Ç–∞–Ω
            </div>
        </div>

        <div class="record-info">
            –ó–∞–ø–∏—Å—å #{{ exam.id }}<br>
            –î–∞—Ç–∞: {{ exam.created_at|date:"d.m.Y / H:i" }}
        </div>

        <div class="section-title">–ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ –ø–∞—Ü–∏–µ–Ω—Ç–µ</div>
        <div class="info-grid">
            <div>
                <span class="label">–ü–∞—Ü–∏–µ–Ω—Ç:</span> <strong>{{ exam.patient.full_name }}</strong>
            </div>
            <div>
                <span class="label">–í—Ä–∞—á:</span> {{ exam.doctor.get_full_name_rus }}
            </div>
            <div>
                <span class="label">–î–∞—Ç–∞ —Ä–æ–∂–¥–µ–Ω–∏—è:</span> {{ exam.patient.birth_date|date:"d.m.Y" }} ({{ exam.patient.age }} –ª–µ—Ç)
            </div>
            <div>
                <span class="label">–¢–µ–ª–µ—Ñ–æ–Ω:</span> {{ exam.patient.phone }}
            </div>
            <div>
                <span class="label">–ü–æ–ª:</span> {{ exam.patient.get_gender_display }}
            </div>
        </div>

        <div class="section-title">–ü—Ä–æ—Ç–æ–∫–æ–ª –∏—Å—Å–ª–µ–¥–æ–≤–∞–Ω–∏—è</div>
        <div>–≠–ª–µ–∫—Ç—Ä–æ–∫–∞—Ä–¥–∏–æ–≥—Ä–∞–º–º–∞ –æ—Ç {{ exam.created_at|date:"d.m.Y" }}</div>
        
        <div class="metrics-box">
            <div>QRS: <strong>{{ exam.qrs_duration|default:"-" }} c</strong></div>
            <div>P: <strong>{{ exam.p_duration|default:"-" }} c</strong></div>
            <div>PQ: <strong>{{ exam.pq_interval|default:"-" }} c</strong></div>
            <div>QT: <strong>{{ exam.qt_interval|default:"-" }} c</strong></div>
            <div>–ß–°–°: <strong>{{ exam.hr|default:"-" }} —É–¥/–º–∏–Ω</strong></div>
        </div>

        <div class="section-title">–ó–∞–∫–ª—é—á–µ–Ω–∏–µ</div>
        
        <p><strong>–†–∏—Ç–º:</strong> {{ exam.rhythm_type }}</p>
        
        <div class="conclusion-box">
            {% if exam.status == 'healthy' %}
                –ü–∞—Ç–æ–ª–æ–≥–∏–π –Ω–µ –≤—ã—è–≤–ª–µ–Ω–æ. –ü–æ–∫–∞–∑–∞—Ç–µ–ª–∏ –≤ –ø—Ä–µ–¥–µ–ª–∞—Ö –Ω–æ—Ä–º—ã.
            {% elif exam.status == 'warning' %}
                –í—ã—è–≤–ª–µ–Ω—ã –Ω–∞—Ä—É—à–µ–Ω–∏—è —Ä–∏—Ç–º–∞. –†–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–æ–µ –æ–±—Å–ª–µ–¥–æ–≤–∞–Ω–∏–µ (–•–æ–ª—Ç–µ—Ä).
                <br><br>
                –ó–∞—Ñ–∏–∫—Å–∏—Ä–æ–≤–∞–Ω—ã —ç–ø–∏–∑–æ–¥—ã –∞—Ä–∏—Ç–º–∏–∏ (—Å–º. –¥–µ—Ç–∞–ª–∏–∑–∞—Ü–∏—é –ò–ò).
            {% else %}
                {{ exam.conclusion|default:"–ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ –∑–∞–∫–ª—é—á–µ–Ω–∏–µ: –¢—Ä–µ–±—É–µ—Ç—Å—è –ø—Ä–æ–≤–µ—Ä–∫–∞ –≤—Ä–∞—á–æ–º." }}
            {% endif %}
            
            {% if exam.conclusion %}
                <br><br><strong>–ö–æ–º–º–µ–Ω—Ç–∞—Ä–∏–π –≤—Ä–∞—á–∞:</strong><br>
                {{ exam.conclusion }}
            {% endif %}
        </div>

        <div class="footer">
            –î–∞–Ω–Ω–æ–µ –∑–∞–∫–ª—é—á–µ–Ω–∏–µ —Å—Ñ–æ—Ä–º–∏—Ä–æ–≤–∞–Ω–æ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ —Å–∏—Å—Ç–µ–º–æ–π ECG_Vision —Å –ø–æ–¥–¥–µ—Ä–∂–∫–æ–π –ò–ò.<br>
            –ù–µ —è–≤–ª—è–µ—Ç—Å—è –æ–∫–æ–Ω—á–∞—Ç–µ–ª—å–Ω—ã–º –¥–∏–∞–≥–Ω–æ–∑–æ–º. –¢—Ä–µ–±—É–µ—Ç—Å—è –∫–æ–Ω—Å—É–ª—å—Ç–∞—Ü–∏—è —Å–ø–µ—Ü–∏–∞–ª–∏—Å—Ç–∞.
        </div>
    </div>

</body>
</html>